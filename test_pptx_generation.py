"""
Test script for PowerPoint generation.
"""

import sys
sys.path.insert(0, '/home/ubuntu/enjaz')

from enjaz.pptx_generator import generate_school_presentation

# Sample school statistics
school_stats = {
    'total_students': 150,
    'total_assessments': 450,
    'total_completed': 360,
    'completion_rate': 80.0,
    'band_distribution': {
        'ุงูุจูุงุชูููุฉ': 25,
        'ุงูุฐูุจูุฉ': 40,
        'ุงููุถูุฉ': 35,
        'ุงูุจุฑููุฒูุฉ': 30,
        'ูุญุชุงุฌ ุฅูู ุชุทููุฑ ูู ุงููุธุงู': 15,
        'ูุง ูุณุชููุฏ ูู ุงููุธุงู': 5
    }
}

# Sample coordinator actions
coordinator_actions = """**ุงูุฅุฌุฑุงุกุงุช ุงููุชุฎุฐุฉ ุนูู ูุณุชูู ุงููุฏุฑุณุฉ:**

**1. ุนูู ุงููุณุชูู ุงูุฅุฏุงุฑู:**
- ุนูุฏ ุงุฌุชูุงุน ุทุงุฑุฆ ูุน ุฌููุน ุฑุคุณุงุก ุงูุฃูุณุงู ูููุงูุดุฉ ูุชุงุฆุฌ ุงูุชูุฑูุฑ
- ุชุดููู ูุฌูุฉ ูุชุงุจุนุฉ ุฏุงุฆูุฉ ูุฑุตุฏ ูุณุจ ุงูุฅูุฌุงุฒ ุฃุณุจูุนูุงู
- ุชุฎุตูุต ููุงุฑุฏ ุฅุถุงููุฉ ููุฃูุณุงู ุฐุงุช ุงูุฃุฏุงุก ุงูููุฎูุถ

**2. ุนูู ูุณุชูู ุงููุนูููู:**
- ุชูุธูู ูุฑุดุฉ ุนูู ูุฌููุน ุงููุนูููู ุญูู ุงุณุชุฑุงุชูุฌูุงุช ุฑูุน ูุณุจุฉ ุงูุฅูุฌุงุฒ
- ูุดุงุฑูุฉ ุฃูุถู ุงูููุงุฑุณุงุช ูู ุงูุฃูุณุงู ุงููุชููุฒุฉ
- ุชูููุฑ ุงูุฏุนู ุงูููู ูููุนูููู ูู ุงุณุชุฎุฏุงู ูุธุงู ูุทุฑ ููุชุนููู

**3. ุนูู ูุณุชูู ุงูุทูุงุจ:**
- ุฅุทูุงู ุญููุฉ ุชุญููุฒูุฉ ุชุญุช ุดุนุงุฑ "ุฅูุฌุงุฒ 100%"
- ุชูุนูู ูุธุงู ุงูููุงูุขุช ููุทูุงุจ ุงููุชููุฒูู
- ุชูุธูู ุฌูุณุงุช ุชูุนููุฉ ููุทูุงุจ ุญูู ุฃูููุฉ ุงูุชููููุงุช ุงูุฃุณุจูุนูุฉ

**4. ุนูู ูุณุชูู ุฃูููุงุก ุงูุฃููุฑ:**
- ุฅุฑุณุงู ุชูุงุฑูุฑ ุฏูุฑูุฉ ูุฃูููุงุก ุงูุฃููุฑ ุนู ุฃุฏุงุก ุฃุจูุงุฆูู
- ุนูุฏ ุงุฌุชูุงุน ุนุงู ูุฃูููุงุก ุงูุฃููุฑ ูุชูุถูุญ ุฃูููุฉ ุงููุชุงุจุนุฉ
- ุชูุนูู ูููุงุช ุงูุชูุงุตู ุงููุจุงุดุฑ (ูุงุชุณุงุจุ ุจุฑูุฏ ุฅููุชุฑููู)

**5. ุงููุชุงุจุนุฉ ูุงูุชูููู:**
- ุฅุนุฏุงุฏ ุชูุฑูุฑ ูุชุงุจุนุฉ ุฃุณุจูุนู ูููุงุณ ุงูุชุญุณู
- ูุฑุงุฌุนุฉ ุงูุฅุฌุฑุงุกุงุช ูุชุนุฏูููุง ุญุณุจ ุงููุชุงุฆุฌ
- ุชุญุฏูุฏ ููุนุฏ ููุชูุฑูุฑ ุงููุงุฏู ุจุนุฏ ุดูุฑ ูุงุญุฏ
"""

# Generate presentation
try:
    output_path = "/home/ubuntu/enjaz/test_school_presentation.pptx"
    result = generate_school_presentation(
        school_stats,
        coordinator_actions,
        output_path
    )
    print(f"โ ุชู ุฅูุดุงุก ุงูุนุฑุถ ุงูุชูุฏููู ุจูุฌุงุญ: {result}")
    
    # Check file size
    import os
    file_size = os.path.getsize(result)
    print(f"๐ ุญุฌู ุงูููู: {file_size / 1024:.2f} KB")
    
except Exception as e:
    print(f"โ ุญุฏุซ ุฎุทุฃ: {str(e)}")
    import traceback
    traceback.print_exc()

